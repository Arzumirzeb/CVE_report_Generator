{% extends 'base.html' %}

{% block title %}CVE Report{% endblock %}

{% block content %}
<div class="report-container">
    <!-- Display CVE Name -->
    <h1>{{ cve_title }}</h1>
    
    <!-- Display CVSS Score -->
    <h2 class="cvss-score">CVSS Score: <span class="cvss-value">{{ cvss_score }}</span></h2>
    <p>CVSS: {{ cvss_vector }}</p>
    
    <!-- Display CVE State -->
    <p><strong>State:</strong> {{ state }}</p>
    
    <p>{{ description }}</p>

    <h3>Affected Assets</h3>
    <table>
        <thead>
            <tr>
                <th>Vendor</th>
                <th>Product</th>
            </tr>
        </thead>
        <tbody>
            {% if affected_assets %}
                {% for asset in affected_assets %}
                <tr>
                    <td>{{ asset.vendor }}</td>
                    <td>{{ asset.product }}</td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="2">No affected assets available</td>
                </tr>
            {% endif %}
        </tbody>
    </table>

    <h3>Exploits</h3>
    <table>
        <thead>
            <tr>
                <th>Exploit Title</th>
                <th>Download Link</th>
                <th>Exploit-DB Link</th>
                <th>Verified</th>
            </tr>
        </thead>
        <tbody>
            {% if exploits %}
                {% for exploit in exploits %}
                <tr>
                    <td>{{ exploit.title }}</td>
                    <td><a href="{{ exploit.download_link }}" target="_blank">Download</a></td>
                    <td><a href="{{ exploit.exploit_link }}" target="_blank">View Exploit</a></td>
                    <td>{{ exploit.verified }}</td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="4">No exploits available</td>
                </tr>
            {% endif %}
        </tbody>
    </table>

    <h3>References</h3>
    <table>
        <thead>
            <tr>
                <th>Description</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody>
            {% if references %}
                {% for reference in references %}
                <tr>
                    <td>{{ reference.description }}</td>
                    <td><a href="{{ reference.link }}" target="_blank">View Reference</a></td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="2">No references available</td>
                </tr>
            {% endif %}
        </tbody>
    </table>

    <!-- Download Links -->
    <div class="download-links">
        <h3>Download Report</h3>
        <a href="{{ url_for('download', file_type='pdf') }}" class="btn">Download PDF</a>
        <a href="{{ url_for('download', file_type='docx') }}" class="btn">Download DOCX</a>
        <a href="{{ url_for('download', file_type='html') }}" class="btn">Download HTML</a>
        <a href="{{ url_for('download', file_type='md') }}" class="btn">Download Markdown</a>
    </div>
</div>
{% endblock %}
